<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}NDBTube{% endblock %}</title>
	<style>
	:root {
		--base: {{ colour_css[0] }};
		--text: {{ colour_css[1] }};
		--light: {{ colour_css[2] }};
		--interactive: {{ colour_css[3] }};
		--extra: {{ colour_css[4] }};
		--extra1: {{ colour_css[5] }};
		--extra2: {{ colour_css[6] }};
		--border: {{ colour_css[7] }};
		--hover: {{ colour_css[8] }};
		--shadow: {{ colour_css[9] }};
	}
	</style>
    <link rel="stylesheet" href="/static/css/Modern_styles.css">
</head>
<body>
    {% set theme = 'light' if colour_css[10] == "True" else 'dark' %}
    
    <!-- Top Bar -->
    <div class="top-bar">
        <div class="top-bar-left">
            <button id="menu-button" title="Toggle Menu">
                <img src="{{ url_for('static', filename='images/' ~ theme ~ '-menu.png') }}" alt="Menu">
            </button>
            <a href="/" class="logo">NDBTube</a>
        </div>
        <!-- Desktop search container -->
		<div class="top-bar-center desktop-only">
			<div class="search-container">
				<form action="/search" method="get" class="search-form">
					<input type="text" name="q" class="search-input" placeholder="Search videos..." required>
					<button type="submit" class="search-button" title="Search">
						<img src="{{ url_for('static', filename='images/' ~ theme ~ '-search.png') }}" alt="Search">
					</button>
				</form>
			</div>
		</div>


        <!-- Mobile: search button and settings button -->
        <div class="top-bar-right">
            <button class="mobile-search-button top-search mobile-only" title="Search">
                <img src="{{ url_for('static', filename='images/' ~ theme ~ '-search.png') }}" alt="Search">
            </button>
            <a href="/settings" class="settings-button" title="Settings">
                <img src="{{ url_for('static', filename='images/' ~ theme ~ '-settings.png') }}" alt="Settings">
            </a>
        </div>
    </div>

    <!-- Basic Sidebar (always visible) -->
    <div class="sidebar basic-sidebar">
        <a href="/" class="sidebar-item">
            <img src="{{ url_for('static', filename='images/' ~ theme ~ '-home.png') }}" alt="Home">
            <span>Home</span>
        </a>
        <a href="/channels" class="sidebar-item">
            <img src="{{ url_for('static', filename='images/' ~ theme ~ '-channel.png') }}" alt="Channel">
            <span>Channels</span>
        </a>
        <a href="/history" class="sidebar-item">
            <img src="{{ url_for('static', filename='images/' ~ theme ~ '-History.png') }}" alt="History">
            <span>History</span>
        </a>
    </div>

    <!-- Advanced Sidebar (hidden by default) -->
    <div class="sidebar advanced-sidebar" id="advanced-sidebar">
        <div class="advanced-header">
            <a href="/" class="logo">NDBTube</a>
            <button id="close-menu" title="Close Menu">
                <img src="{{ url_for('static', filename='images/' ~ theme ~ '-close.png') }}" alt="Close">
            </button>
        </div>
        <a href="/" class="sidebar-item">
            <img src="{{ url_for('static', filename='images/' ~ theme ~ '-home.png') }}" alt="Home">
            <span>Home</span>
        </a>
        <a href="/channels" class="sidebar-item">
            <img src="{{ url_for('static', filename='images/' ~ theme ~ '-channel.png') }}" alt="Channel">
            <span>Channels</span>
        </a>
        <a href="/history" class="sidebar-item">
            <img src="{{ url_for('static', filename='images/' ~ theme ~ '-History.png') }}" alt="History">
            <span>History</span>
        </a>
        <div class="channels-list">
            <h3>Quick Access:</h3>
            {% for channel in channels %}
                <a class="channel-item" href="{{ channel.uploader_id }}">
                    <img src="{{ channel.channel_icon }}" alt="{{ channel.uploader }}" class="channel-icon">
                    <span>{{ channel.uploader }}</span>
                </a>
            {% endfor %}
        </div>
    </div>

    <!-- Overlay for advanced sidebar -->
    <div id="overlay"></div>

    <!-- Mobile Search Modal -->
	<div id="mobile-search-modal" class="mobile-search-modal">
		<div class="mobile-search-container">
			<form action="/search" method="get" class="mobile-search-form">
				<input type="text" name="q" class="mobile-search-input" placeholder="Search videos..." required>
				<button type="submit" class="mobile-search-button" title="Search">
					<img src="{{ url_for('static', filename='images/' ~ theme ~ '-search.png') }}" alt="Search">
				</button>
			</form>
			<button class="mobile-search-close" title="Close Search">
				<img src="{{ url_for('static', filename='images/' ~ theme ~ '-close.png') }}" alt="Close">
			</button>
		</div>
	</div>



    <!-- Main Content -->
    <div class="main-content">
        {% block content %}{% endblock %}
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var menuButton = document.getElementById('menu-button');
            var advancedSidebar = document.getElementById('advanced-sidebar');
            var closeButton = document.getElementById('close-menu');
            var overlay = document.getElementById('overlay');
            var mobileSearchButton = document.querySelector('.mobile-search-button.top-search');
            var mobileSearchModal = document.getElementById('mobile-search-modal');
            var mobileSearchClose = document.querySelector('.mobile-search-close');

            // Open the advanced sidebar
            menuButton.addEventListener('click', function() {
                advancedSidebar.classList.add('open');
                overlay.classList.add('open');
            });

            // Close advanced sidebar via close button
            closeButton.addEventListener('click', function() {
                advancedSidebar.classList.remove('open');
                overlay.classList.remove('open');
            });

            // Close advanced sidebar when clicking the overlay
            overlay.addEventListener('click', function() {
                advancedSidebar.classList.remove('open');
                overlay.classList.remove('open');
            });

            // Mobile search: clicking the mobile search button opens the modal
            mobileSearchButton.addEventListener('click', function(e) {
                if (window.innerWidth <= 768) {
                    e.preventDefault();
                    mobileSearchModal.classList.add('open');
                }
            });

            // Close the mobile search modal
            mobileSearchClose.addEventListener('click', function() {
                mobileSearchModal.classList.remove('open');
            });
            mobileSearchModal.addEventListener('click', function(e) {
                if (e.target === mobileSearchModal) {
                    mobileSearchModal.classList.remove('open');
                }
            });
        });
    </script>
</body>
</html>
